# 客户端限流

系统在gateway端提供针对**IP**的限流配置

## 配置项

| 配置项            | 默认值 | 说明                                                                                                                     |
| ----------------- | ------ | ------------------------------------------------------------------------------------------------------------------------ |
| throttle          | false  | 关闭false 开启true                                                                                                       |
| throttle_interval | 10000  | 流量发放间隔时间 毫秒                                                                                                    |
| throttle_times    | 100    | 每次发放流量数                                                                                                           |
| throttle_close    | 2      | 达到流量阈值的动作类型 0丢弃请求 1关闭当前客户端 2关闭当前客户端(强制) 3关闭当前ip下的所有客户端 4关闭当前ip下的所有客户端(强制) |

## 参考代码

每隔10000毫秒发放100次请求量 达到流量阈值将强制关闭客户端

``` php
<?php

declare(strict_types=1);

use Xielei\Swoole\Gateway;

require_once __DIR__ . '/vendor/autoload.php';

$gateway = new Gateway();

$gateway->throttle = true; // 是否开启限流功能 开启true 关闭false
$gateway->throttle_interval = 10000; // 流量发放间隔时间 单位:毫秒
$gateway->throttle_times = 100; // 每次发放流量数
$gateway->throttle_close = 2; // 达到流量阈值将关闭当前客户端

$gateway->listen('127.0.0.1', 9901);

$gateway->start();

```
